---
title: "Shannon index"
author: "Rajani"
date: "January 18, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


```{r}
library(ggplot2)
packageVersion("ggplot2")
library(vegan)
library(permute)
library(lattice)
packageVersion("vegan")
library(MASS)
packageVersion("MASS")
library(phyloseq)
```



Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
```{r}
path <- "C:/Users/rthanis/Desktop/16SsequencingForMS"
ps <- readRDS(file.path(path, "ps.prop.RDS"))
ps_Canine <- readRDS(file.path(path, "ps.prop_Canine.RDS"))
ps_Equine <- readRDS(file.path(path, "ps_Equine.RDS"))
(ps_CanineAb <- subset_samples(ps_Canine, Ab != "NA"))
saveRDS(ps_CanineAb ,"C:/Users/rthanis/Desktop/16SsequencingForMS/ps_CanineAb.RDS")
(ps_CanineGI <- subset_samples(ps_Canine, GI != "NA"))
saveRDS(ps_CanineGI ,"C:/Users/rthanis/Desktop/16SsequencingForMS/ps_CanineGI.RDS")
plot_richness(ps, x="Species", measures=c("Chao1", "Shannon", "Simpson", "Observed", "InvSimpson"), color="CD")
ggsave("C:/Users/rthanis/Desktop/ClinicalProject/ManuscriptPrep/Microbiome/AllSpeciesAlphadiversity.pdf", width = 8, height = 5, units = "in")
plot_richness(ps, measures=c("InvSimpson"), color="CD")+facet_wrap(~Species, scales="free_x")+theme(
        axis.text.x=element_blank())
ggsave("C:/Users/rthanis/Desktop/ClinicalProject/ManuscriptPrep/Microbiome/InvSimpsonAllSpecies.pdf", width = 8, height = 8, units = "in")
plot_richness(ps_Canine, measures=c("InvSimpson"), color="CD")+theme(
        axis.text.x=element_blank())
ggsave("C:/Users/rthanis/Desktop/ClinicalProject/ManuscriptPrep/Microbiome/InvSimpsonCanineCD.pdf", width = 8, height = 8, units = "in")
plot_richness(ps_CanineAb, measures=c("InvSimpson"), color="Ab")+theme(
        axis.text.x=element_blank())
ggsave("C:/Users/rthanis/Desktop/ClinicalProject/ManuscriptPrep/Microbiome/InvSimpsonCanineAb.pdf", width = 8, height = 8, units = "in")
plot_richness(ps_CanineGI, measures=c("InvSimpson"), color="GI")+theme(
        axis.text.x=element_blank())
ggsave("C:/Users/rthanis/Desktop/ClinicalProject/ManuscriptPrep/Microbiome/InvSimpsonCanineGI.pdf", width = 8, height = 8, units = "in")
plot_richness(ps_CanineAb, measures=c("InvSimpson"), color="CD")+facet_wrap(~Ab, scales="free_x")+theme(
        axis.text.x=element_blank())
ggsave("C:/Users/rthanis/Desktop/ClinicalProject/ManuscriptPrep/Microbiome/InvSimpsonCanineAbplusCD.pdf", width = 8, height = 8, units = "in")
plot_richness(ps_CanineGI, measures=c("InvSimpson"), color="CD")+facet_wrap(~GI, scales="free_x")+theme(
        axis.text.x=element_blank())
ggsave("C:/Users/rthanis/Desktop/ClinicalProject/ManuscriptPrep/Microbiome/InvSimpsonCanineGIplusCD.pdf", width = 8, height = 8, units = "in")
plot_richness(ps_Equine, measures=c("InvSimpson"), color="CD")+theme(
        axis.text.x=element_blank())
ggsave("C:/Users/rthanis/Desktop/ClinicalProject/ManuscriptPrep/Microbiome/InvSimpsonEquine.pdf", width = 8, height = 8, units = "in")
```



